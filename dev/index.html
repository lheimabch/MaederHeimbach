<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to MaxwellWave · MaxwellWave.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="http://MaxwellWave.almaeder.com/stable/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">MaxwellWave.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Introduction to MaxwellWave</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Maxwell-Wave"><span>Maxwell Wave</span></a></li><li><a class="tocitem" href="#Authors"><span>Authors</span></a></li><li class="toplevel"><a class="tocitem" href="#Derivation-Partial-Differentaial-Equation"><span>Derivation Partial Differentaial Equation</span></a></li><li><a class="tocitem" href="#Linear-Lossy-Problem"><span>Linear Lossy Problem</span></a></li><li><a class="tocitem" href="#\\chi3-Nonlinear-Lossy-Problem"><span><span>$\chi^3$</span> Nonlinear Lossy Problem</span></a></li><li class="toplevel"><a class="tocitem" href="#Boundary-Condition"><span>Boundary Condition</span></a></li><li><a class="tocitem" href="#Perfect-Electric-Conductor-Boundary-Conditions"><span>Perfect Electric Conductor Boundary Conditions</span></a></li><li><a class="tocitem" href="#Perfect-Absorbing-Boundary-Conditions"><span>Perfect Absorbing Boundary Conditions</span></a></li><li class="toplevel"><a class="tocitem" href="#Results"><span>Results</span></a></li><li><a class="tocitem" href="#Homogenous-2D-Problem"><span>Homogenous 2D Problem</span></a></li><li><a class="tocitem" href="#Homogenous-3D-Problem"><span>Homogenous 3D Problem</span></a></li><li><a class="tocitem" href="#Absorbing-3D-Problem"><span>Absorbing 3D Problem</span></a></li><li><a class="tocitem" href="#Nonlinear-3D-Problem"><span>Nonlinear 3D Problem</span></a></li><li class="toplevel"><a class="tocitem" href="#Conclusion-and-Possible-Extensions"><span>Conclusion and Possible Extensions</span></a></li><li><a class="tocitem" href="#Conclusion"><span>Conclusion</span></a></li><li><a class="tocitem" href="#Possible-Extensions"><span>Possible Extensions</span></a></li><li class="toplevel"><a class="tocitem" href="#Running-the-Project-Examples"><span>Running the Project Examples</span></a></li><li><a class="tocitem" href="#Local-Documentation"><span>Local Documentation</span></a></li><li><a class="tocitem" href="#Testing-Locally"><span>Testing Locally</span></a></li><li><a class="tocitem" href="#Running-Locally"><span>Running Locally</span></a></li><li><a class="tocitem" href="#Running-on-Piz-Daint"><span>Running on Piz Daint</span></a></li><li><a class="tocitem" href="#Visualization"><span>Visualization</span></a></li></ul></li><li><a class="tocitem" href="wave2D.html">Wave 2D</a></li><li><a class="tocitem" href="wave3D.html">Wave 3D</a></li><li><a class="tocitem" href="wave3DnonlinearChi3.html">Nonlinear Chi3 Wave 3D</a></li><li><a class="tocitem" href="auxiliary.html">Auxiliary</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Introduction to MaxwellWave</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Introduction to MaxwellWave</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction-to-MaxwellWave"><a class="docs-heading-anchor" href="#Introduction-to-MaxwellWave">Introduction to MaxwellWave</a><a id="Introduction-to-MaxwellWave-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction-to-MaxwellWave" title="Permalink"></a></h1><ul><li><a href="index.html#Introduction-to-MaxwellWave">Introduction to MaxwellWave</a></li><li><a href="index.html#Maxwell-Wave">Maxwell Wave</a></li><li class="no-marker"><ul><li><a href="index.html#Authors">Authors</a></li></ul></li><li><a href="index.html#Derivation-Partial-Differentaial-Equation">Derivation Partial Differentaial Equation</a></li><li class="no-marker"><ul><li><a href="index.html#Linear-Lossy-Problem">Linear Lossy Problem</a></li><li><a href="index.html#\\chi3-Nonlinear-Lossy-Problem"><span>$\chi^3$</span> Nonlinear Lossy Problem</a></li></ul></li><li><a href="index.html#Boundary-Condition">Boundary Condition</a></li><li class="no-marker"><ul><li><a href="index.html#Perfect-Electric-Conductor-Boundary-Conditions">Perfect Electric Conductor Boundary Conditions</a></li><li><a href="index.html#Perfect-Absorbing-Boundary-Conditions">Perfect Absorbing Boundary Conditions</a></li></ul></li><li><a href="index.html#Results">Results</a></li><li class="no-marker"><ul><li><a href="index.html#Homogenous-2D-Problem">Homogenous 2D Problem</a></li><li><a href="index.html#Homogenous-3D-Problem">Homogenous 3D Problem</a></li><li><a href="index.html#Absorbing-3D-Problem">Absorbing 3D Problem</a></li><li><a href="index.html#Nonlinear-3D-Problem">Nonlinear 3D Problem</a></li></ul></li><li><a href="index.html#Conclusion-and-Possible-Extensions">Conclusion and Possible Extensions</a></li><li class="no-marker"><ul><li><a href="index.html#Conclusion">Conclusion</a></li><li><a href="index.html#Possible-Extensions">Possible Extensions</a></li></ul></li><li><a href="index.html#Running-the-Project-Examples">Running the Project Examples</a></li><li class="no-marker"><ul><li><a href="index.html#Local-Documentation">Local Documentation</a></li><li><a href="index.html#Testing-Locally">Testing Locally</a></li><li><a href="index.html#Running-Locally">Running Locally</a></li><li><a href="index.html#Running-on-Piz-Daint">Running on Piz Daint</a></li><li><a href="index.html#Visualization">Visualization</a></li></ul></li><li><a href="wave2D.html#Wave-2D">Wave 2D</a></li><li><a href="wave3D.html#Wave-3D">Wave 3D</a></li><li><a href="wave3DnonlinearChi3.html#Nonlinear-Chi3-Wave-3D">Nonlinear Chi3 Wave 3D</a></li><li><a href="auxiliary.html#Auxiliary">Auxiliary</a></li></ul><h1 id="Maxwell-Wave"><a class="docs-heading-anchor" href="#Maxwell-Wave">Maxwell Wave</a><a id="Maxwell-Wave-1"></a><a class="docs-heading-anchor-permalink" href="#Maxwell-Wave" title="Permalink"></a></h1><p><a href="https://github.com/lheimabch/MaederHeimbach/actions/workflows/CI.yml"><img src="https://github.com/lheimabch/MaederHeimbach/actions/workflows/CI.yml/badge.svg" alt="Build Status"/></a></p><p>The goal of this project is to solve the electromagnetic wave equation in 3D.</p><p>The documentation is hosted under <a href="https://lheimabch.github.io/MaederHeimbach/dev/">MaxwellWave</a></p><h2 id="Authors"><a class="docs-heading-anchor" href="#Authors">Authors</a><a id="Authors-1"></a><a class="docs-heading-anchor-permalink" href="#Authors" title="Permalink"></a></h2><ul><li>Lothar Heimbach, Master&#39;s Student in Computational Science and Engineering at ETH Zurich</li><li>Alexander Maeder, Master&#39;s Student in Electrical Engineering and Information Technology at ETH Zurich</li></ul><h1 id="Derivation-Partial-Differentaial-Equation"><a class="docs-heading-anchor" href="#Derivation-Partial-Differentaial-Equation">Derivation Partial Differentaial Equation</a><a id="Derivation-Partial-Differentaial-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Derivation-Partial-Differentaial-Equation" title="Permalink"></a></h1><p>For the derivation, we start with the general Maxwell&#39;s equation:</p><p class="math-container">\[\nabla \cdot \vec{D}\left(\vec{r},t\right) = p_0\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \times \vec{E}\left(\vec{r},t\right) = - \frac{\partial}{\partial t}\vec{B}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \times \vec{H}\left(\vec{r},t\right) = \frac{\partial}{\partial t} \vec{D}\left(\vec{r},t\right) + \vec{j}_0\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \cdot \vec{B}\left(\vec{r},t\right) = 0\]</p><p>We have to further supplement this system of equations with constitutive relations.</p><h2 id="Linear-Lossy-Problem"><a class="docs-heading-anchor" href="#Linear-Lossy-Problem">Linear Lossy Problem</a><a id="Linear-Lossy-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-Lossy-Problem" title="Permalink"></a></h2><p>We choose for the first problem setting a nonmagnetic dielectric with no free charges and no nonlinearities:&lt;br /&gt;</p><p class="math-container">\[p_0\left(\vec{r},t\right) = 0\]</p><p class="math-container">\[\vec{j}_0\left(\vec{r},t\right) = \sigma\left(\vec{r},t\right) \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\vec{D}\left(\vec{r},t\right) = \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\vec{B}\left(\vec{r},t\right) = \mu_0 \vec{H}\left(\vec{r},t\right)\]</p><p>We then insert these constitutive relations in the maxwell equations and arrive at the system:</p><p class="math-container">\[\nabla \cdot \left( \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \vec{E}\left(\vec{r},t\right) \right) = 0\]</p><p class="math-container">\[\nabla \times \vec{E}\left(\vec{r},t\right) = - \mu_0 \frac{\partial}{\partial t}\vec{H}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \times \vec{H}\left(\vec{r},t\right) = \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \frac{\partial}{\partial t} \vec{E}\left(\vec{r},t\right) + \sigma\left(\vec{r},t\right) \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \cdot \vec{H}\left(\vec{r},t\right) = 0\]</p><p>To further simplify the system, we apply multiple transformations and vector calculus identities:</p><p class="math-container">\[\nabla \times \nabla \times \vec{E}\left(\vec{r},t\right) = - \mu_0 \frac{\partial}{\partial t} \nabla \times \vec{H}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \times \nabla \times \vec{E}\left(\vec{r},t\right) = - \mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \frac{\partial^2}{\partial t^2}\vec{E}\left(\vec{r},t\right) -\mu_0 \left(\frac{\partial}{\partial t}\sigma\left(\vec{r},t\right)\right)\vec{E}\left(\vec{r},t\right) -\mu_0\sigma\left(\vec{r},t\right) \left(\frac{\partial}{\partial t}\vec{E}\left(\vec{r},t\right)\right)\]</p><p class="math-container">\[\nabla \times \nabla \times \vec{E}\left(\vec{r},t\right) = \nabla \left(\nabla \cdot \vec{E}\left(\vec{r},t\right)\right) - \nabla^2 \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[0 = \nabla \cdot \left(\varepsilon_r\left(\vec{r}\right) \vec{E}\left(\vec{r},t\right) \right) = \varepsilon_r\left(\vec{r}\right) \nabla \cdot \vec{E}\left(\vec{r},t\right) + \nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \cdot \vec{E}\left(\vec{r},t\right) = -\frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)}\]</p><p class="math-container">\[\nabla \times \nabla \times \vec{E}\left(\vec{r},t\right) = -\nabla \left(\frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} \right) - \nabla^2 \vec{E}\left(\vec{r},t\right)\]</p><p>With all of these simplifications, we arrive at the final equation for the electric field, which we want to solve: </p><p class="math-container">\[\nabla^2 \vec{E}\left(\vec{r},t\right) + \nabla \left(\frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} \right) - \mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \frac{\partial^2}{\partial t^2}\vec{E}\left(\vec{r},t\right) -\mu_0 \left(\frac{\partial}{\partial t}\sigma\left(\vec{r},t\right)\right)\vec{E}\left(\vec{r},t\right) -\mu_0\sigma\left(\vec{r},t\right) \left(\frac{\partial}{\partial t}\vec{E}\left(\vec{r},t\right)\right) = 0\]</p><p>Which can be equivalently formulated as: </p><p class="math-container">\[\frac{\partial}{\partial t}\begin{bmatrix}
        \vec{u}\left(\vec{r},t\right)\\
        \vec{v}\left(\vec{r},t\right)\\
    \end{bmatrix} 
    = \begin{bmatrix}
        0 &amp; 1\\
        -\frac{\frac{\partial}{\partial t}\sigma\left(\vec{r},t\right)}{\varepsilon_0 \varepsilon_r\left(\vec{r}\right)} &amp; -\frac{\sigma\left(\vec{r},t\right)}{\varepsilon_0 \varepsilon_r\left(\vec{r}\right)} \\
    \end{bmatrix}
    \begin{bmatrix}
        \vec{u}\left(\vec{r},t\right)\\
        \vec{v}\left(\vec{r},t\right)\\
    \end{bmatrix} + 
    \begin{bmatrix}
        0\\
        \frac{1}{\mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right)}\nabla^2 \vec{u}\left(\vec{r},t\right) + \frac{1}{\mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right)} \nabla \left(\frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{u}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} \right)\\
    \end{bmatrix}\]</p><p class="math-container">\[\vec{u}\left(\vec{r},t\right) = \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\vec{v}\left(\vec{r},t\right) = \frac{\partial}{\partial t} \vec{E}\left(\vec{r},t\right)\]</p><h2 id="\\chi3-Nonlinear-Lossy-Problem"><a class="docs-heading-anchor" href="#\\chi3-Nonlinear-Lossy-Problem"><span>$\chi^3$</span> Nonlinear Lossy Problem</a><a id="\\chi3-Nonlinear-Lossy-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#\\chi3-Nonlinear-Lossy-Problem" title="Permalink"></a></h2><p>We choose for the second problem a more general setting such that third harmonic effects can be captured by the simulation. We assume the following constitutive relations:&lt;br /&gt;</p><p class="math-container">\[p_0\left(\vec{r},t\right) = 0\]</p><p class="math-container">\[\vec{j}_0\left(\vec{r},t\right) = \sigma\left(\vec{r},t\right) \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\vec{D}\left(\vec{r},t\right) = \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \vec{E}\left(\vec{r},t\right) + \varepsilon_0 \chi^3\left(\vec{r}\right)\left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\vec{B}\left(\vec{r},t\right) = \mu_0 \vec{H}\left(\vec{r},t\right)\]</p><p>We then insert these constitutive relations in the maxwell equations and arrive at the system:</p><p class="math-container">\[\nabla \cdot \left( \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \vec{E}\left(\vec{r},t\right) + \varepsilon_0 \chi^3\left(\vec{r}\right)\left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right) \right) = 0\]</p><p class="math-container">\[\nabla \times \vec{E}\left(\vec{r},t\right) = - \mu_0 \frac{\partial}{\partial t}\vec{H}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \times \vec{H}\left(\vec{r},t\right) = \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \frac{\partial}{\partial t} \vec{E}\left(\vec{r},t\right) + \varepsilon_0 \chi^3\left(\vec{r}\right) \frac{\partial}{\partial t} \left( \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right)\right) + \sigma\left(\vec{r},t\right) \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \cdot \vec{H}\left(\vec{r},t\right) = 0\]</p><p>We have to simplify to get a solvable form:</p><p class="math-container">\[\nabla \times \nabla \times \vec{E}\left(\vec{r},t\right) = - \mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \frac{\partial^2}{\partial t^2} \vec{E}\left(\vec{r},t\right) - \mu_0 \varepsilon_0 \chi^3\left(\vec{r}\right) \frac{\partial^2}{\partial t^2} \left( \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right)\right) - \mu_0 \frac{\partial \sigma\left(\vec{r},t\right)}{\partial t} \vec{E}\left(\vec{r},t\right)- \mu_0 \frac{\partial \vec{E}\left(\vec{r},t\right)}{\partial t}\sigma\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \times \nabla \times \vec{E}\left(\vec{r},t\right) = \nabla \left(\nabla \cdot \vec{E}\left(\vec{r},t\right)\right) - \nabla^2 \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\nabla \cdot \vec{E}\left(\vec{r},t\right) = - \frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} - \frac{1}{\varepsilon \left(\vec{r}\right)} \nabla \cdot \left(\chi^3\left(\vec{r}\right)\left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right) \right)\]</p><p class="math-container">\[\nabla \left(\nabla \cdot \vec{E}\left(\vec{r},t\right)\right) - \nabla^2 \vec{E}\left(\vec{r},t\right) = - \nabla^2 \vec{E}\left(\vec{r},t\right) + \nabla \left( - \frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} - \frac{1}{\varepsilon \left(\vec{r}\right)} \nabla \cdot \left(\chi^3\left(\vec{r}\right)\left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right) \right) \right)\]</p><p class="math-container">\[\frac{\partial^2}{\partial t^2} \left( \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right)\right) = \frac{\partial}{\partial t} \left( \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \frac{\partial}{\partial t} \vec{E}\left(\vec{r},t\right) + 2 \left(\sum \frac{\partial}{\partial t} \left\lvert E_i \left(\vec{r},t\right) \right\rvert \right)\vec{E}\left(\vec{r},t\right)\right)\]</p><p class="math-container">\[\frac{\partial^2}{\partial t^2} \left( \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right)\right) = \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \frac{\partial^2}{\partial t^2} \vec{E}\left(\vec{r},t\right) + 4 \left(\sum \frac{\partial}{\partial t} \left\lvert E_i \left(\vec{r},t\right) \right\rvert \right) \frac{\partial}{\partial t}\vec{E}\left(\vec{r},t\right) + 2\left(\sum \frac{\partial^2}{\partial t^2} \left\lvert E_i \left(\vec{r},t\right) \right\rvert \right)\vec{E}\left(\vec{r},t\right)\]</p><p>Through the addition of the nonlinear term, we get a nasty term that makes it impossible to write the equation system in a clean matrix form as there is a sum over second-order time derivatives. We introduce an approximation to mitigate this problem. We assume that the absolute square of the electric field is a slowly varying function of time:</p><p class="math-container">\[\frac{\partial^2}{\partial t^2} \left( \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right)\right) \approx \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \frac{\partial^2}{\partial t^2} \vec{E}\left(\vec{r},t\right)\]</p><p>Then we can plug everything into one equation:</p><p class="math-container">\[- \nabla^2 \vec{E}\left(\vec{r},t\right) + \nabla \left( - \frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{E}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} - \frac{1}{\varepsilon \left(\vec{r}\right)} \nabla \cdot \left(\chi^3\left(\vec{r}\right)\left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right) \right) \right) = - \mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) \frac{\partial^2}{\partial t^2} \vec{E}\left(\vec{r},t\right) - \mu_0 \varepsilon_0 \chi^3\left(\vec{r}\right) \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \frac{\partial^2}{\partial t^2} \vec{E}\left(\vec{r},t\right) - \mu_0 \frac{\partial \sigma\left(\vec{r},t\right)}{\partial t} \vec{E}\left(\vec{r},t\right)- \mu_0 \frac{\partial \vec{E}\left(\vec{r},t\right)}{\partial t}\sigma\left(\vec{r},t\right)\]</p><p>As in the previous linear problem, we can write a system of equations:</p><p class="math-container">\[\frac{\partial}{\partial t}\begin{bmatrix}
        \vec{u}\left(\vec{r},t\right)\\
        \vec{v}\left(\vec{r},t\right)\\
    \end{bmatrix} 
    = \begin{bmatrix}
        0 &amp; 1\\
        -\frac{\frac{\partial}{\partial t}\sigma\left(\vec{r},t\right)}{\varepsilon_0 \varepsilon_r\left(\vec{r}\right) + \varepsilon_0 \chi^3\left(\vec{r}\right) \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2} &amp; -\frac{\sigma\left(\vec{r},t\right)}{\varepsilon_0 \varepsilon_r\left(\vec{r}\right) + \varepsilon_0 \chi^3\left(\vec{r}\right) \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2} \\
    \end{bmatrix}
    \begin{bmatrix}
        \vec{u}\left(\vec{r},t\right)\\
        \vec{v}\left(\vec{r},t\right)\\
    \end{bmatrix} + 
    \begin{bmatrix}
        0\\
        \frac{1}{\mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) + \mu_0\varepsilon_0 \chi^3\left(\vec{r}\right) \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2}\nabla^2 \vec{u}\left(\vec{r},t\right) + \frac{1}{\mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) + \mu_0\varepsilon_0 \chi^3\left(\vec{r}\right) \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2} \nabla \left(\frac{\nabla \varepsilon_r\left(\vec{r}\right) \cdot \vec{u}\left(\vec{r},t\right)}{\varepsilon_r\left(\vec{r}\right)} \right) + \frac{1}{\mu_0 \varepsilon_0 \varepsilon_r\left(\vec{r}\right) + \mu_0\varepsilon_0 \chi^3\left(\vec{r}\right) \left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2} \nabla \left(\frac{1}{\varepsilon \left(\vec{r}\right)} \nabla \cdot \left(\chi^3\left(\vec{r}\right)\left\lvert \vec{E}\left(\vec{r},t\right)\right\rvert^2 \vec{E}\left(\vec{r},t\right) \right) \right)\\
    \end{bmatrix}\]</p><p class="math-container">\[\vec{u}\left(\vec{r},t\right) = \vec{E}\left(\vec{r},t\right)\]</p><p class="math-container">\[\vec{v}\left(\vec{r},t\right) = \frac{\partial}{\partial t} \vec{E}\left(\vec{r},t\right)\]</p><h1 id="Boundary-Condition"><a class="docs-heading-anchor" href="#Boundary-Condition">Boundary Condition</a><a id="Boundary-Condition-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Condition" title="Permalink"></a></h1><p>In this project, we use various types of boundary conditions for modeling different physical systems:</p><h2 id="Perfect-Electric-Conductor-Boundary-Conditions"><a class="docs-heading-anchor" href="#Perfect-Electric-Conductor-Boundary-Conditions">Perfect Electric Conductor Boundary Conditions</a><a id="Perfect-Electric-Conductor-Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Perfect-Electric-Conductor-Boundary-Conditions" title="Permalink"></a></h2><p>This boundary condition model a perfect metallic mirror. The whole field is reflected at the boundary and no field is allowed to exist inside the mirror. The perfect electric conductor is represented through the Dirichlet boundary condition:</p><p class="math-container">\[\vec{E}\left(\vec{r},t\right) = 0, \; \vec{r} \in \partial \Omega_{PEC}\]</p><h2 id="Perfect-Absorbing-Boundary-Conditions"><a class="docs-heading-anchor" href="#Perfect-Absorbing-Boundary-Conditions">Perfect Absorbing Boundary Conditions</a><a id="Perfect-Absorbing-Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Perfect-Absorbing-Boundary-Conditions" title="Permalink"></a></h2><p>Perfect absorbing boundary conditions should model infinite free space propagation of the field without reflections.</p><p>A first naive idea is to use again the perfect electric conductor boundary conditions, but introduce a highly absorbing conductivity layer at the boundary.</p><p>Another choice for the perfect absorbing boundary conditions is the zeroth order approximation. This choice is represented through the following mixed boundary condition:</p><p class="math-container">\[\frac{\partial}{\partial t}\vec{E}\left(\vec{r},t\right) + c \left(\vec{n} \cdot \nabla \right)\vec{E}\left(\vec{r},t\right), \; \vec{r} \in \partial \Omega_{PA0}\]</p><p>Where <span>$c$</span> is the speed of light in the boundary medium and <span>$\vec{n}$</span> is the outwards pointing boundary normal vector. This condition can be rewritten in the following way:</p><p class="math-container">\[\vec{v}\left(\vec{r},t\right) = - c \left(\vec{n} \cdot \nabla \right)\vec{u}\left(\vec{r},t\right), \; \vec{r} \in \partial \Omega_{PA0}\]</p><p>Therefore, the velocity can be directly calculated on the boundary and is not undefined anymore as before. In addition, we need the value of <span>$\vec{u}\left(\vec{r},t\right)$</span> on the boundary. This field we get through applying the update rule not only on the inside of the domain but on the absorbing boundary.</p><h1 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h1><p>In the following chapter, we present plots and gifs resulting from running different physics examples. All of the 2D codes were run on four GPUs, whereas the 3D ones were on eight GPUs:</p><h2 id="Homogenous-2D-Problem"><a class="docs-heading-anchor" href="#Homogenous-2D-Problem">Homogenous 2D Problem</a><a id="Homogenous-2D-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Homogenous-2D-Problem" title="Permalink"></a></h2><p>In the first example, we simulate the 2D homogenous wave equation in a vacuum. The reflecting boundary condition is chosen. The field is initialized with a cosine-modulated gaussian pulse.  </p><p>&lt;!– <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_Ez.gif" alt/> –&gt; <img src="../homogeneous_dirichlet_Ez.gif" alt/></p><p>We plot only the z-component because there is no coupling between different polarizations in a vacuum. </p><h2 id="Homogenous-3D-Problem"><a class="docs-heading-anchor" href="#Homogenous-3D-Problem">Homogenous 3D Problem</a><a id="Homogenous-3D-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Homogenous-3D-Problem" title="Permalink"></a></h2><p>As a second example, we simulate the full equation derived in the linear lossy problem section with reflecting boundary conditions. We chose a static conductivity and both permeability/conductivity are plotted below:</p><p><img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_vecE_3D_epsilon.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_vecE_3D_sigma.png" alt/></p><p>As the initial condition, we chose a y-polarized pulse. It has the shape of a  hyperbolic secant in the x-direction and a gaussian in the y/z-direction. This pulse is set to propagate in the positive x-direction: <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_vecE_3D_inituy.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_vecE_3D_sliceplty.gif" alt/></p><p>In the following plots, we present the time evolution of the vector field. We omit to plot the z-component because it is vanishing with the chosen material parameters: <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_vecE_3D_slicepltx.gif" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/homogeneous_dirichlet_vecE_3D_initvy.png" alt/> We can see that there is a coupling from linear y-polarized field to x/y-elliptic polarized with a gaussian shaped dielectric waveguide.</p><h2 id="Absorbing-3D-Problem"><a class="docs-heading-anchor" href="#Absorbing-3D-Problem">Absorbing 3D Problem</a><a id="Absorbing-3D-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Absorbing-3D-Problem" title="Permalink"></a></h2><p>As in the previous example, we simulate the equation of the linear lossy problem section. In contrast, we changed the boundary condition and the material parameters. We applied on the left y/z-plane a first-order perfect absorbing boundary condition. </p><p><img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/absorbing_boundary_vecE_3D_epsilon.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/absorbing_boundary_vecE_3D_sigma.png" alt/></p><p>The initial conditions are not changed: <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/absorbing_boundary_vecE_3D_inituy.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/absorbing_boundary_vecE_3D_sliceplty.gif" alt/></p><p>As in the previous example, we plot only the x/y-component: <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/absorbing_boundary_vecE_3D_slicepltx.gif" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/absorbing_boundary_vecE_3D_initvy.png" alt/> Since we simulate for a longer period of time, we can see that the field is fully absorbed in the left plane. This is due to the fact that first-order absorbing boundary conditions are perfect if the wavevector is perpendicular to the surface.</p><h2 id="Nonlinear-3D-Problem"><a class="docs-heading-anchor" href="#Nonlinear-3D-Problem">Nonlinear 3D Problem</a><a id="Nonlinear-3D-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Nonlinear-3D-Problem" title="Permalink"></a></h2><p>We simulate the derived system of equation in the <span>$\chi^3$</span> nonlinear lossy problem section with only perfect reflecting boundary conditions. </p><p>The material parameters are not changed, but a <span>$\chi^3$</span> is defined. We chose that only nonlinear effects happen in the center of the domain: <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_epsilon.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_sigma.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_chi3.png" alt/></p><p>The initial conditions are again not changed: <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_inituy.png" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_sliceplty.gif" alt/></p><p>We omit again the z-component, since even with nonlinear effect the coupling to the z-component is small.  <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_slicepltx.gif" alt/> <img src="https://github.com/lheimabch/MaederHeimbach/blob/main/MaxwellWave/docs/nonlinear_vecE_3D_initvy.png" alt/> The effect of nonlinearity is difficult to see. We would need to calculate the instantaneous frequency, because new frequencies are generated and the pulse gets chirped.</p><h1 id="Conclusion-and-Possible-Extensions"><a class="docs-heading-anchor" href="#Conclusion-and-Possible-Extensions">Conclusion and Possible Extensions</a><a id="Conclusion-and-Possible-Extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion-and-Possible-Extensions" title="Permalink"></a></h1><h2 id="Conclusion"><a class="docs-heading-anchor" href="#Conclusion">Conclusion</a><a id="Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion" title="Permalink"></a></h2><p>In the previous section, we presented multiple simulations of Maxwell&#39;s equation with different assumptions on the constitutive relations, boundary conditions, and material parameters. There we demonstrated scalability on many GPUs/CPUs to compute large-scale electromagnetism problems with high accuracy. Now different time domain problems such as nonlinear pulse formation or transmission characteristics of photonic components over a large bandwidth can be investigated. </p><h2 id="Possible-Extensions"><a class="docs-heading-anchor" href="#Possible-Extensions">Possible Extensions</a><a id="Possible-Extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Possible-Extensions" title="Permalink"></a></h2><p>For the above-mentioned problems, we would need to change the material parameters and depending on the problem chose different boundary conditions. In addition, to get transmission characteristics we would have to implement a port boundary condition. Where a high bandwidth pulse can be directly inserted at the boundary and every reflection is absorbed. Then we would need to Fourier transform the inserted/transmitted/reflected signals to get transmission characteristics in the frequency domain with a single simulation. </p><p>On the technical side, we could implement low-level optimization for the GPU kernel such as the use of shared memory. For such optimizations, we should first investigate the performance metric of our implemented kernels, which is a missing feature due to time constraints.  In addition, for the absorbing boundary condition we could implement a more general kernel c, which applies depending on function arguments the boundary condition.</p><h1 id="Running-the-Project-Examples"><a class="docs-heading-anchor" href="#Running-the-Project-Examples">Running the Project Examples</a><a id="Running-the-Project-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-Project-Examples" title="Permalink"></a></h1><p>One has to instantiate the Julia project first before running any script:</p><pre><code class="language-bash hljs">julia --project -e &#39;using Pkg; Pkg.instantiate()&#39;</code></pre><h2 id="Local-Documentation"><a class="docs-heading-anchor" href="#Local-Documentation">Local Documentation</a><a id="Local-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Local-Documentation" title="Permalink"></a></h2><p>One has to run the following commands to create documentation locally:</p><pre><code class="language-bash hljs">cd docs/
julia --project make.jl</code></pre><p>It will create a build folder with the documentation inside as described in <a href="https://documenter.juliadocs.org/stable/man/guide/">Documenter Guide</a>.</p><h2 id="Testing-Locally"><a class="docs-heading-anchor" href="#Testing-Locally">Testing Locally</a><a id="Testing-Locally-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-Locally" title="Permalink"></a></h2><p>The following commands will precompile the project, check dependencies and run the tests according to <a href="https://docs.julialang.org/en/v1/stdlib/Test/">Unit Test</a>:</p><pre><code class="language-bash hljs">julia --project -e &#39;using Pkg; Pkg.test()&#39;</code></pre><h2 id="Running-Locally"><a class="docs-heading-anchor" href="#Running-Locally">Running Locally</a><a id="Running-Locally-1"></a><a class="docs-heading-anchor-permalink" href="#Running-Locally" title="Permalink"></a></h2><p>As most of the scripts use MPI, one has to configure the right MPI binary with <a href="https://juliaparallel.org/MPI.jl/stable/configuration/">MPIPreferences</a>. For example, if one wants to use the system MPI binary:</p><pre><code class="language-bash hljs">julia --project -e &#39;using MPIPreferences; MPIPreferences.use_system_binary()&#39;</code></pre><p>Afterward, the example can be run in the following way:</p><pre><code class="language-bash hljs">mpiexec -n X julia --project examples/homogeneous_dirichlet_Ez_2D.jl
mpiexec -n X julia --project examples/homogeneous_dirichlet_vecE_3D.jl
mpiexec -n X julia --project examples/absorbing_boundary_vecE_3D.jl
mpiexec -n X julia --project examples/nonlinear_vecE_3D.jl</code></pre><p>Where X is the number of ranks to run. The flag USE_GPU inside the scripts has to be set to choose between running on CPU or GPU. </p><h2 id="Running-on-Piz-Daint"><a class="docs-heading-anchor" href="#Running-on-Piz-Daint">Running on Piz Daint</a><a id="Running-on-Piz-Daint-1"></a><a class="docs-heading-anchor-permalink" href="#Running-on-Piz-Daint" title="Permalink"></a></h2><p>Inside the example folder, there are bash scripts for the different examples to run on Pz Daint:</p><pre><code class="language-bash hljs">sbatch examples/homogeneous_dirichlet_Ez_2D.sh
sbatch examples/homogeneous_dirichlet_vecE_3D.sh
sbatch examples/absorbing_boundary_vecE_3D.sh
sbatch examples/nonlinear_vecE_3D.sh</code></pre><h2 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h2><p>The following scripts have to be executed after running the simulations to create the presented plots in the result section:</p><pre><code class="language-bash hljs">julia --project examples/homogeneous_dirichlet_Ez_2D_viz.jl</code></pre><pre><code class="language-bash hljs">julia --project examples/vecE_3D_viz.jl</code></pre><p>Where in the &quot;vecE<em>3D</em>viz.jl&quot; multiple settings have to be changed depending on &quot;homogeneous<em>dirichlet</em>vecE<em>3D&quot;/&quot;absorbing</em>boundary<em>vecE</em>3D&quot;/&quot;nonlinear<em>vecE</em>3D&quot;. The settings &quot;example<em>name&quot; &quot;dims&quot;, &quot;epsilon&quot;, &quot;sigma&quot;, &quot;chi3&quot;, &quot;u</em>pulse<em>shape&quot;, and &quot;v</em>pulse_shape&quot; should match the simulation. </p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="wave2D.html">Wave 2D »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 31 December 2022 11:29">Saturday 31 December 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
